# CA-ALNS Repro: Full Reproduction Scaffold

This repository contains a complete scaffold to **reproduce all tables and figures** for the paper:
> *Connectivity-Aware Adaptive Large Neighborhood Search with Rally-Point Assistance for Multi-UAV Routing under FANET Connectivity Constraints*

---

## Quick Start

```bash
# 1) Create and activate a Python env
python -m venv .venv
source .venv/bin/activate

# 2) Install deps
pip install -r requirements.txt

# 3) Make sure Python sees the repo's src
export PYTHONPATH="$(pwd)/src:$PYTHONPATH"
```

> **Tip:** You can also use the provided `Makefile` targets below.

---

## What Gets Produced

- **Raw run JSONs** (per algorithm/seed/scale) under `runs/`
- **Aggregate CSV** of all runs at `results/runs.csv`
- **Statistics & Tables** (Wilcoxon, Holm–Bonferroni, Cliff’s δ, A12, CI) in `results/tables.tex`
- **Figures** (convergence, eval-profile, scaling; plus `ns-3` figures if logs provided) under `figs/`
- **ns-3** traces and aggregate metrics (optional) under `ns3_traces/` and `results/ns3_*.csv`

---

## Scales, Algorithms, Budgets

- **Scales** (default mapping):
  - `Small`: 5 UAV / 20 targets
  - `Medium`: 10 / 50
  - `Large`: 20 / 100
  - `XL` (stress): 50 / 1000
- **Algorithms**:
  - `de`, `ga`, `alns-std`, `alns-ls`, `ca-alns`
- **Fairness**: same `E_max` (e.g. 100000) and `T_max` (e.g. 600 s) across algorithms

> **Note:** The current `experiments/run_experiment.py` generates **Small** by default.
> For Medium/Large/XL, apply the small patch under `patches/add_scale_cli.diff` (adds `--n_uav`/`--n_targets`).
> After that, the Makefile and `scripts/run_grid.py` will automatically pass scale settings.

---

## One-Command Reproduction

```bash
# All scales × algos × seeds (default seeds 0..29)
make all
```

What this does:

1. `make runs` – concrete runs under `runs/$(SCALE)/$(ALGO)/seed_*.json`
2. `make aggregate` – merge into `results/runs.csv`
3. `make stats` – write `results/tables.tex` (LaTeX-ready)
4. `make plots` – create figures in `figs/`
5. `make ns3` – (optional) export traces + aggregate ns-3 logs if available

---

## ns-3 Packet-Level Validation (Optional)

We provide a pipeline to produce **PDR**, **delay**, **hop-count** metrics with ns-3. In summary:

1. Export traces:
   ```bash
   make ns3-export SCALE=Medium ALGO=ca-alns
   ```
2. Use your own ns-3 script (e.g. `scratch/fanet_validate.cc`) to read `ns3_traces/` and write logs into `ns3_logs/Medium/`.
3. Aggregate:
   ```bash
   make ns3-aggregate SCALE=Medium
   ```
4. Plot figures:
   ```bash
   make ns3-plots SCALE=Medium
   ```

> See `docs/ns3_pipeline.md` for details and recommended PHY/MAC parameters (matching the paper).

---

## Filling LaTeX Placeholders

In your LaTeX, replace values or include figures via tokens (e.g. `%%AUTO:SMALL_CA_COST_MED%%`).
Then run:

```bash
make fill-tex TEX=paper/main.tex OUT=paper/main_filled.tex
```

This calls `analysis/fill_placeholders.py` using `results/tables.json` mapping (generated by `make stats`).

---

## Make Targets (Summary)

```bash
make runs           # Run full grid (scales x algos x seeds)
make aggregate      # results/runs.csv
make stats          # results/tables.tex + results/tables.json
make plots          # figs/*
make ns3            # export traces + aggregate + plots (if ns3 logs exist)
make clean          # remove runs/results/figs/ns3_traces/ns3_logs
```

Further details are in the Makefile.

---

## License and Citation

- License is **MIT** (see `LICENSE`).
- If you use this code or results, please cite using `CITATION.cff`.
